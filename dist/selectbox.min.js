/**
 * Selectbox.js 0.1.0 (2014-11-13) - Stylized Selectbox UI
 * Bogdan Chadkin - https://github.com/TrySound/Selectbox.js
 * Free to use under terms of MIT license
 */

!function(a){"use strict";a(window,document)}(function(a,b){"use strict";function c(){this._instances={},this._def()}function d(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)}function e(a,b){d(a,b)||(a.className+=(a.className?" ":"")+b)}function f(a,b){d(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}function g(a,b){var c=b.parentNode,d=b.nextSibling;d?c.insertBefore(a,d):c.appendChild(a)}function h(c){var d,e=c.cloneNode(!0);e.style.cssText=["width: "+a.getComputedStyle(c).width,"height: auto","visibility: hidden","position: absolute"].join("; "),b.body.appendChild(e),d=a.getComputedStyle(e).height,e.remove(),c.style.height=d}function i(c,d){for(var e,f,g=a.innerHeight,h=a.pageYOffset||b.documentElement.scrollTop,i=0,j=c,k=parseInt(a.getComputedStyle(c).height,10);j;)i+=parseFloat(j.offsetTop),j=j.offsetParent;i=Math.round(i),f=i-h,e=g+k-f,e>f?(d.style.top="100%",d.style.bottom="auto",d.style.maxHeight=e-2.5*k+"px"):(d.style.top="auto",d.style.bottom="100%",d.style.maxHeight=f-k/2+"px")}function j(a){this._instances=a.instances,this._settings=a.settings}function k(){this._instances=new c,this._selector=new j({instances:this._instances,settings:{}})}function l(a,c){var d,e,f,g=function(){};if(!a)return null;if(!(this instanceof l))return new l(a,c);for(m||(m=new k),this._main=m,c=c||{},c.onInit=c.onInit||g,c.onChange=c.onChange||g,c.onOpen=c.onOpen||g,c.onClose=c.onClose||g,c.onEnable=c.onEnable||g,c.onDisable=c.onDisable||g,this._settings=c,d="string"==typeof a?b.querySelectorAll(a):a.length?a:[a],this._targets=[],e=0,f=d.length;f>e;e++)this._main.attach(d[e],c),this._targets.push(d[e])}c.prototype={_gen:function(){var a=this._defaultHTML.cloneNode(!0);return{container:a,toggle:a.getElementsByClassName("sb-toggle")[0],selector:a.getElementsByClassName("sb-selector")[0],options:a.getElementsByClassName("sb-options")[0]}},_def:function(){var a=b.createElement("div"),c=b.createElement("div"),d=b.createElement("div"),e=b.createElement("ul");a.className="sb-container",c.className="sb-toggle",d.className="sb-selector",e.className="sb-options",a.appendChild(c),a.appendChild(d),a.appendChild(e),this._defaultHTML=a},create:function(a){var b=Math.floor(99999999*Math.random());return a&&a.setAttribute?(a.setAttribute("data-sb",b),this._instances[b]={target:a,uid:b,open:!1,disabled:!1,el:this._gen(),settings:{}},this._instances[b]):void 0},get:function(a){return a&&a.getAttribute?this._instances[a.getAttribute("data-sb")]:void 0},remove:function(a){a&&a.getAttribute&&(this._instances[a.getAttribute("data-sb")]=null)}},j.prototype={_getOptions:function(a){var c,d,e,f,g,h,i=b.createDocumentFragment();for(c=0,d=a.length;d>c;c++)f=a[c],e=b.createElement("li"),e.innerHTML=f.text,e.setAttribute("data-sb-index",f.index),e.className="sb-option",("OPTGROUP"===f.parentNode.tagName&&f.parentNode.disabled||f.disabled)&&(e.className+=" sb-option-disabled",e.setAttribute("data-sb-disabled",!0)),"OPTGROUP"===f.parentNode.tagName&&(f.parentNode!==h&&(h=f.parentNode,g=b.createElement("li"),g.className="sb-group"+(h.disabled?" sb-group-disabled":""),g.innerHTML=h.getAttribute("label"),i.appendChild(g)),e.className+=" sb-option-sub"),i.appendChild(e);return i},set:function(a,b){var c=this._instances.get(a);c.selected&&(c.selected.selected=!1),b.selected=!0,c.selected=b,c.el.selector.innerHTML=b.text},_setDefault:function(a){var b=a.querySelectorAll("option[selected]"),c=b?b[b.length-1]:null;c||(c=a.getElementsByTagName("option")[0]),c&&this.set(a,c)},attach:function(a){var b=this._getOptions(a),c=this._instances.get(a);c.el.options.appendChild(b),this._setDefault(a)}},k.prototype={_attachEvents:function(a){function c(){e.disabled||(e.open?d.close(a):d.open(a))}var d=this,e=this._instances.get(a);e.el.options.addEventListener("click",function(b){var c=b.target;e.disabled||!c.hasAttribute("data-sb-index")||c.getAttribute("data-sb-disabled")||(d.change(a,c),d.close(a))},!1),e.el.selector.addEventListener("click",c),e.el.toggle.addEventListener("click",c),b.documentElement.addEventListener("mousedown",function(b){!e.disabled&&e.open&&b.target.parentNode!==e.el.options&&b.target!==e.el.options&&b.target!==e.el.selector&&b.target!==e.el.toggle&&d.close(a)},!1)},attach:function(a,b){var c=this._instances.get(a);c||(c=this._instances.create(a),this._selector.attach(a),a.style.display="none",c.settings=b||{},a.disabled?this.disable(a,!0):c.el.container.className+=" sb-enabled",this._attachEvents(a),g(c.el.container,a),setTimeout(function(){c.settings.onInit.call(c.target,c)},20))},detach:function(a){var b=this._instances.get(a),c=b.el.container,d=c.cloneNode(!0);c.parentNode.replaceChild(d,c),d.remove(),this._instances.remove(a),a.style.display=""},enable:function(a,b){var c=this._instances.get(a);c.disabled&&(c.disabled=!1,c.target.disabled=!1,f(c.el.container,"sb-disabled"),c.el.container.className+=" sb-enabled",b||c.settings.onEnable.call(c.target,c))},disable:function(a,b){var c=this._instances.get(a);this.close(a),c.disabled||(c.disabled=!0,c.target.disabled=!0,f(c.el.container,"sb-enabled"),c.el.container.className+=" sb-disabled",b||c.settings.onDisable.call(c.target,c))},open:function(a,b){var c=this._instances.get(a);c.disabled||c.open||(c.open=!0,c.el.container.className+=" sb-open",h(c.el.options),i(c.el.container,c.el.options),b||c.settings.onOpen.call(c.target,c))},close:function(a,b){var c=this._instances.get(a);c.open&&(c.open=!1,f(c.el.container,"sb-open"),c.el.options.style.height="",b||c.settings.onClose.call(c.target,c))},change:function(a,b){var c=this._instances.get(a);c.selectedItem&&f(c.selectedItem,"sb-option-active"),this._selector.set(a,a[b.getAttribute("data-sb-index")]),e(b,"sb-option-active"),c.selectedItem=b,c.settings.onChange.call(a,c)}};var m=null;l.prototype={attach:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.attach(c[a],this._settings)},detach:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.detach(c[a])},enable:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.enable(c[a])},disable:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.disable(c[a])},open:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.open(c[a])},close:function(){var a,b,c=this._targets;for(a=0,b=c.length;b>a;a++)this._main.close(c[a])}},a.Selectbox=l});