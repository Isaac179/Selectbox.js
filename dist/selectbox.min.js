/**
 * Selectbox.js 0.2.1 (2014-11-16) - VanillaJS Custom Selectbox UI
 * Bogdan Chadkin - https://github.com/TrySound/Selectbox.js
 * Free to use under terms of MIT license
 */

!function(a){"use strict";window.Selectbox=a(window,document)}(function(a,b){"use strict";function c(){this._instances={},this._default=null}function d(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")}function e(a,b){d(a,b)||(a.className+=(a.className?" ":"")+b)}function f(a,b){d(a,b)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}function g(a,b){var c=b.parentNode,d=b.nextSibling;d?c.insertBefore(a,d):c.appendChild(a)}function h(c){var d,e=c.cloneNode(!0),f=a.getComputedStyle;e.style.cssText=["width: "+f(c).width,"height: auto","visibility: hidden","position: absolute"].join("; "),b.body.appendChild(e),d=f(e).height,e.parentNode.removeChild(e),c.style.height=d}function i(c,d){for(var e,f,g=a.innerHeight,h=a.pageYOffset||b.documentElement.scrollTop,i=0,j=c,k=parseInt(a.getComputedStyle(c).height,10);j;)i+=parseFloat(j.offsetTop),j=j.offsetParent;i=Math.round(i),f=i-h,e=g+k-f,e>f?(d.style.top="100%",d.style.bottom="auto",d.style.maxHeight=e-2.5*k+"px"):(d.style.top="auto",d.style.bottom="100%",d.style.maxHeight=f-k/2+"px")}function j(a){this._instances=a.instances,this._settings=a.settings}function k(){this._instances=new c,this._selector=new j({instances:this._instances,settings:{}})}function l(a,c){return this instanceof l?(this._settings=c||{},this._targets=a?"string"==typeof a?b.querySelectorAll(a):a.tagName?[a]:a.length?a:[]:[],this._main=m?m:m=new k,void this.attach()):new l(a,c)}c.prototype={_generate:function(a){var c,d,e,f;return this._default||(c=b.createElement("div"),d=b.createElement("div"),e=b.createElement("div"),f=b.createElement("ul"),c.className=a+"container",d.className=a+"toggle",e.className=a+"selector",f.className=a+"options",c.appendChild(d),c.appendChild(e),c.appendChild(f),this._default=c),c=this._default.cloneNode(!0),{container:c,toggle:c.children[0],selector:c.children[1],options:c.children[2]}},create:function(a){var b=Math.floor(99999999*Math.random());return a&&a.setAttribute?(a.setAttribute("data-sb",b),this._instances[b]={target:a,uid:b,open:!1,disabled:!1,el:this._generate("sb-"),settings:{}},this._instances[b]):void 0},get:function(a){return a&&a.getAttribute?this._instances[a.getAttribute("data-sb")]:void 0},remove:function(a){a&&a.getAttribute&&(this._instances[a.getAttribute("data-sb")]=null)}},j.prototype={_getOptions:function(a){var c,d,e,f,g,h,i=b.createDocumentFragment();for(c=0,d=a.length;d>c;c++)f=a[c],e=b.createElement("li"),e.innerHTML=f.text,e.setAttribute("data-sb-index",f.index),e.className="sb-option",("OPTGROUP"===f.parentNode.tagName&&f.parentNode.disabled||f.disabled)&&(e.className+=" sb-option-disabled",e.setAttribute("data-sb-disabled",!0)),"OPTGROUP"===f.parentNode.tagName&&(f.parentNode!==h&&(h=f.parentNode,g=b.createElement("li"),g.className="sb-group"+(h.disabled?" sb-group-disabled":""),g.innerHTML=h.getAttribute("label"),i.appendChild(g)),e.className+=" sb-option-sub"),i.appendChild(e);return i},set:function(a,b){var c=this._instances.get(a);c.selected&&(c.selected.selected=!1),b.selected=!0,c.selected=b,c.el.selector.innerHTML=b.text},_setDefault:function(a){var b=a.querySelectorAll("option[selected]"),c=b?b[b.length-1]:null;c||(c=a.getElementsByTagName("option")[0]),c&&this.set(a,c)},attach:function(a){var b=this._getOptions(a),c=this._instances.get(a);c.el.options.appendChild(b),this._setDefault(a)}},k.prototype={_change:function(a,b){var c=this._instances.get(a);c.selectedItem&&f(c.selectedItem,"sb-option-active"),this._selector.set(a,a[b.getAttribute("data-sb-index")]),e(b,"sb-option-active"),c.selectedItem=b,c.settings.onChange&&c.settings.onChange.call(a,c)},_attachEvents:function(a){function c(){e.disabled||(e.open?d.close(a):d.open(a))}var d=this,e=this._instances.get(a);e.el.options.addEventListener("click",function(b){var c=b.target;e.disabled||!c.hasAttribute("data-sb-index")||c.getAttribute("data-sb-disabled")||(d._change(a,c),d.close(a))},!1),e.el.selector.addEventListener("click",c),e.el.toggle.addEventListener("click",c),b.documentElement.addEventListener("mousedown",function(b){!e.disabled&&e.open&&b.target.parentNode!==e.el.container&&b.target.parentNode!==e.el.options&&d.close(a)},!1)},attach:function(a,b){var c,d=this._instances.get(a);if(d)for(c in b)b.hasOwnProperty(c)&&(d.settings[c]=b[c]);else d=this._instances.create(a),this._selector.attach(a),a.style.display="none",d.settings=b||{},a.hasAttribute("data-sb-custom")&&(d.settings.custom=a.getAttribute("data-sb-custom")),d.settings.custom&&(d.el.container.className+=" "+d.settings.custom),a.disabled?this.disable(a,!0):d.el.container.className+=" sb-enabled",this._attachEvents(a),g(d.el.container,a),setTimeout(function(){d.settings.onInit&&d.settings.onInit.call(a,d)},20)},detach:function(a){var b,c,d=this._instances.get(a);d&&(b=d.el.container,c=b.cloneNode(!0),b.parentNode.replaceChild(c,b),c.parentNode.removeChild(c),this._instances.remove(a),a.style.display="")},enable:function(a){var b=this._instances.get(a);b&&b.disabled&&(b.disabled=!1,b.target.disabled=!1,f(b.el.container,"sb-disabled"),b.el.container.className+=" sb-enabled",b.settings.onEnable&&b.settings.onEnable.call(a,b))},disable:function(a){var b=this._instances.get(a);this.close(a),b&&!b.disabled&&(b.disabled=!0,b.target.disabled=!0,f(b.el.container,"sb-enabled"),b.el.container.className+=" sb-disabled",b.settings.onDisable&&b.settings.onDisable.call(a,b))},open:function(a){var b=this._instances.get(a);!b||b.disabled||b.open||(b.open=!0,b.el.container.className+=" sb-open",h(b.el.options),i(b.el.container,b.el.options),b.settings.onOpen&&b.settings.onOpen.call(a,b))},close:function(a){var b=this._instances.get(a);b&&b.open&&(b.open=!1,f(b.el.container,"sb-open"),b.el.options.style.height="",b.settings.onClose&&b.settings.onClose.call(a,b))}};var m=null;return l.prototype={_each:function(a){var b,c,d=this._targets,e=this._settings,f=this._main[a].bind(this._main);for(b=0,c=d.length;c>b;b++)f(d[b],e)},attach:function(){this._each("attach")},detach:function(){this._each("detach")},enable:function(){this._each("enable")},disable:function(){this._each("disable")},open:function(){this._each("open")},close:function(){this._each("close")}},b.addEventListener("DOMContentLoaded",function(){l(".sb-init")},!1),l});